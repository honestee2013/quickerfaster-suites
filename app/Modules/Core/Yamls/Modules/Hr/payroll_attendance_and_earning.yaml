models:
  AttendanceSession:
    module: hr
    fields:
      attendance_date:
        type: datepicker
        validation:
          - required
        modifiers:
          nullable: true

      employee_id:
        type: string
        label: Employee ID
        autoGenerate: true
        modifiers:
          nullable: true
        validation:
          - required|unique:employee_profiles,employee_id


      check_in_time:
        type: timepicker
        validation:
          - required
        modifiers:
          nullable: true

      check_out_time:
        type: timepicker
        validation:
          - required
        modifiers:
          nullable: true

      scheduled_start:
        type: timepicker
        modifiers:
          nullable: true

      scheduled_end:
        type: timepicker
        modifiers:
          nullable: true

      check_in_status:
        type: string
        modifiers:
          nullable: true

      check_in_diff_mins:
        type: integer
        default: 0
        validation:
          - integer|min:0
        modifiers:
          nullable: true

      check_out_status:
        type: string
        modifiers:
          nullable: true


      check_out_diff_mins:
        type: integer
        default: 0
        validation:
          - integer|min:0
        modifiers:
          nullable: true


      session_minutes:
        type: integer
        default: 0
        validation:
          - integer|min:0
        modifiers:
          nullable: true


      device_id:
        type: string
        validation:
          - required
        modifiers:
          nullable: true

      latitude:
        type: integer
        modifiers:
          nullable: true
          precision: 10,6 # Common precision for latitude/longitude

      longitude:
        type: integer
        modifiers:
          nullable: true
          precision: 10,6 # Common precision for latitude/longitude


      # employee_profile_id:
      #   type: select
      #   label: Employee Profile ID
      #   foreign:
      #     table: employee_profiles
      #     column: id
      #     onDelete: cascade
      #   validation:
      #     - nullable


      # sync_status:
      #   type: select
      #   options: pending, success, failed # Example statuses
      #   default: pending
      #
      # sync_attempts:
      #   type: integer
      #   default: 0
      #   validation:
      #     - required|integer|min:0



    hiddenFields:
      onTable: ["employee_profile_id"]
      onNewForm: ["employee_profile_id"]
      onEditForm: ["employee_profile_id"]
      onQuery: []

    tab:
      label: Daily Attendance
      group: attendance-and-earning
      id: daily-attendance
      parentPageTitle: Attendance & Earning
      pageTitle: Daily Attendance Overview
      view: daily-attendance
      url: hr/daily-attendance

    fieldGroups:
      - title: Attendance Details
        groupType: hr
        fields:
          - attendance_date
          - employee_id
          - attendance_type
          - attendance_time
          - scheduled_start
          - check_status
          - minutes_difference
          - scheduled_end
          - device_id

      - title: Location & Sync
        groupType: hr
        fields:
          - latitude
          - longitude
          - sync_status
          - sync_attempts

    relations:
      employee:
        type: belongsTo
        model: App\Modules\Hr\Models\EmployeeProfile # Adjust namespace if needed
        foreignKey: employee_id
        displayField: employee_id # Or appropriate display field

    sidebar:
      add: true
      title: Attendance & Earnings
      iconClasses: fas fa-clipboard-check # Or a more suitable icon
      submenu:
        - title: Daily Attendance
          url: daily-attendance
          iconClasses: fas fa-list # Or a more suitable icon
        - title: Daily Earnings
          url: daily-earnings
          iconClasses: fas fa-money-bill-wave-alt # Or a more suitable icon




    iconClasses: fas fa-fingerprint # Or a more suitable icon
    includeHeader: false
    includeFooter: false
    includeSidebar: true
    controls: all
    simpleActions: ['show', 'edit', 'delete']




  DailyEarning:
    module: hr
    fields:
      employee_id:
        type: string
        label: Employee ID
        validation:
          - required

      work_date:
        type: datepicker
        validation:
          - required
        modifiers:
          nullable: true


      regular_hours:
        type: decimal
        modifiers:
          precision: 5,2
          default: 0.00
          nullable: true

      overtime_hours:
        type: decimal
        modifiers:
          precision: 5,2
          default: 0.00
          nullable: true

      total_hours:
        type: decimal
        modifiers:
          precision: 5,2
          default: 0.00
          nullable: true

      regular_amount:
        type: decimal
        modifiers:
          precision: 10,2
          default: 0.00
          nullable: true


      overtime_amount:
        type: decimal
        modifiers:
          precision: 10,2
          default: 0.00
          nullable: true


      total_amount:
        type: decimal
        modifiers:
          precision: 10,2
          default: 0.00
          nullable: true


      # employee_profile_id:
      #   type: select
      #   label: Employee Profile ID
      #   foreign:
      #     table: employee_profiles
      #     column: id
      #     onDelete: cascade
      #   validation:
      #     - nullable


    hiddenFields:
      onTable: ["employee_profile_id"]
      onNewForm: ["employee_profile_id"]
      onEditForm: ["employee_profile_id"]
      onQuery: []

    tab:
      label: Daily Earnings
      group: attendance-and-earning
      id: daily-earnings
      parentPageTitle: Attendance & Earning
      pageTitle: Daily Earnings Overview
      view: daily-earnings
      url: hr/daily-earnings

    fieldGroups:
      - title: Hours Details
        groupType: hr
        fields:
          - employee_id
          - work_date
          - regular_hours
          - overtime_hours
          - total_hours

      - title: Earning Details
        groupType: hr
        fields:
          - regular_amount
          - overtime_amount
          - total_amount



    #relations:
    #  employeeProfile:
    #    type: belongsTo
    #    model: App\Modules\Hr\Models\EmployeeProfile # Adjust namespace if needed
    #    foreignKey: employee_id
    #    displayField: employee_id # Or 'user.name' if joining through user

    sidebar:
      add: false
    #  title: Daily Earnings
    #  iconClasses: fas fa-money-bill-wave-alt # Or a more suitable icon

    iconClasses: fas fa-wallet # Or a more suitable icon
    includeHeader: true
    includeFooter: true
    includeSidebar: true
    controls: all
    simpleActions: ['show', 'edit', 'delete']




# $table->index(['employee_id', 'attendance_date']); // For daily_attendances
# $table->index(['employee_id', 'work_date']);       // For daily_earnings
# $table->index(['role_id', 'day_of_week_id']);      // For role_schedules


# // In daily_attendances
# $table->foreignId('employee_id')->nullable()->constrained('employees', 'id')->nullOnDelete();
# // In daily_earnings
# $table->foreignId('employee_id')->constrained('employees', 'id')->cascadeOnDelete();

# // Prevent duplicate daily earnings records on on Daily Earnings table
# $table->unique(['employee_id', 'work_date']);


# // on daily_attendances
# $table->string('clock_method')->nullable(); // 'face', 'qr', 'manual', etc.


